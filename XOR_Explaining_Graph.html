<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Network Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }
        
        .network-architecture {
            text-align: center;
            margin: 30px 0;
        }
        
        .layer {
            display: inline-block;
            margin: 0 30px;
            vertical-align: top;
        }
        
        .layer-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .neuron {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin: 8px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .neuron:hover {
            transform: scale(1.1);
        }
        
        .connection {
            display: inline-block;
            width: 60px;
            height: 2px;
            background: #95a5a6;
            vertical-align: middle;
            margin: 0 10px;
            position: relative;
        }
        
        .arrow {
            position: absolute;
            right: -5px;
            top: -3px;
            width: 0;
            height: 0;
            border-left: 8px solid #95a5a6;
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .highlight {
            background: #f39c12;
            color: #2c3e50;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .formula {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .interactive-section {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .btn {
            background: #00b894;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #00a085;
        }
        
        #training-output {
            background: #2d3436;
            color: #ddd;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† Neural Network Explained with Graphs</h1>
            <p>A complete visual guide to understanding our XOR neural network</p>
        </div>

        <!-- Network Architecture -->
        <div class="section">
            <h2>üèóÔ∏è Network Architecture</h2>
            <div class="network-architecture">
                <div class="layer">
                    <div class="layer-title">Input Layer<br>(2 neurons)</div>
                    <div class="neuron">X‚ÇÅ</div>
                    <div class="neuron">X‚ÇÇ</div>
                </div>
                
                <div class="connection"><div class="arrow"></div></div>
                
                <div class="layer">
                    <div class="layer-title">Hidden Layer<br>(8 neurons)</div>
                    <div class="neuron">H‚ÇÅ</div>
                    <div class="neuron">H‚ÇÇ</div>
                    <div class="neuron">H‚ÇÉ</div>
                    <div class="neuron">H‚ÇÑ</div>
                    <div class="neuron">H‚ÇÖ</div>
                    <div class="neuron">H‚ÇÜ</div>
                    <div class="neuron">H‚Çá</div>
                    <div class="neuron">H‚Çà</div>
                </div>
                
                <div class="connection"><div class="arrow"></div></div>
                
                <div class="layer">
                    <div class="layer-title">Output Layer<br>(1 neuron)</div>
                    <div class="neuron">Y</div>
                </div>
            </div>
        </div>

        <!-- Forward Pass -->
        <div class="section">
            <h2>‚û°Ô∏è Forward Pass Explanation</h2>
            <div class="step-number">1</div><strong>Input to Hidden Layer:</strong>
            <div class="formula">
                z‚ÇÅ = X ¬∑ W‚ÇÅ + b‚ÇÅ<br>
                a‚ÇÅ = sigmoid(z‚ÇÅ)
            </div>
            
            <div class="step-number">2</div><strong>Hidden to Output Layer:</strong>
            <div class="formula">
                z‚ÇÇ = a‚ÇÅ ¬∑ W‚ÇÇ + b‚ÇÇ<br>
                output = sigmoid(z‚ÇÇ)
            </div>
            
            <div class="code-block">
def forward(self, X):
    # Input to hidden layer
    self.z1 = np.dot(X, self.W1) + self.b1
    self.a1 = <span class="highlight">sigmoid(self.z1)</span>
    
    # Hidden to output layer  
    self.z2 = np.dot(self.a1, self.W2) + self.b2
    self.a2 = <span class="highlight">sigmoid(self.z2)</span>
    
    return self.a2
            </div>
        </div>

        <!-- Sigmoid Function -->
        <div class="section">
            <h2>üìà Sigmoid Activation Function</h2>
            <div class="chart-container">
                <canvas id="sigmoidChart"></canvas>
            </div>
            <p><strong>Formula:</strong> œÉ(x) = 1 / (1 + e‚ÅªÀ£)</p>
            <p><strong>Properties:</strong> Outputs between 0 and 1, smooth gradient, differentiable</p>
        </div>

        <!-- XOR Problem -->
        <div class="section">
            <h2>üîÑ XOR Problem Visualization</h2>
            <div class="grid">
                <div>
                    <h3>Truth Table</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background: #3498db; color: white;">
                            <th style="padding: 10px; border: 1px solid #ddd;">X‚ÇÅ</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">X‚ÇÇ</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">XOR</th>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center; background: #e74c3c; color: white;">0</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">1</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center; background: #27ae60; color: white;">1</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">1</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center; background: #27ae60; color: white;">1</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">1</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">1</td>
                            <td style="padding: 10px; border: 1px solid #ddd; text-align: center; background: #e74c3c; color: white;">0</td>
                        </tr>
                    </table>
                </div>
                <div>
                    <h3>2D Visualization</h3>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="xorChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backpropagation -->
        <div class="section">
            <h2>‚¨ÖÔ∏è Backpropagation Explanation</h2>
            
            <div class="step-number">1</div><strong>Calculate Output Error:</strong>
            <div class="formula">dz‚ÇÇ = output - y</div>
            
            <div class="step-number">2</div><strong>Calculate Weight Gradients (W‚ÇÇ):</strong>
            <div class="formula">dW‚ÇÇ = (1/m) √ó a‚ÇÅ·µÄ √ó dz‚ÇÇ</div>
            
            <div class="step-number">3</div><strong>Calculate Bias Gradients (b‚ÇÇ):</strong>
            <div class="formula">db‚ÇÇ = (1/m) √ó sum(dz‚ÇÇ)</div>
            
            <div class="step-number">4</div><strong>Calculate Hidden Layer Error:</strong>
            <div class="formula">
                da‚ÇÅ = dz‚ÇÇ √ó W‚ÇÇ·µÄ<br>
                dz‚ÇÅ = da‚ÇÅ √ó sigmoid'(a‚ÇÅ)
            </div>
            
            <div class="step-number">5</div><strong>Update Weights:</strong>
            <div class="formula">
                W‚ÇÇ = W‚ÇÇ - learning_rate √ó dW‚ÇÇ<br>
                W‚ÇÅ = W‚ÇÅ - learning_rate √ó dW‚ÇÅ
            </div>
        </div>

        <!-- Interactive Training -->
        <div class="interactive-section">
            <h2>üöÄ Interactive Training Simulation</h2>
            <p>Click the button below to simulate training and watch the loss decrease!</p>
            <button class="btn" onclick="simulateTraining()">Start Training Simulation</button>
            <button class="btn" onclick="resetTraining()">Reset</button>
            
            <div id="training-output"></div>
            
            <div class="chart-container">
                <canvas id="lossChart"></canvas>
            </div>
        </div>

        <!-- Weight Initialization -->
        <div class="section">
            <h2>‚öñÔ∏è Weight Initialization Comparison</h2>
            <div class="chart-container">
                <canvas id="initChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Sigmoid function chart
        const sigmoidCtx = document.getElementById('sigmoidChart').getContext('2d');
        const xValues = [];
        const sigmoidValues = [];
        const sigmoidDerivValues = [];
        
        for (let x = -6; x <= 6; x += 0.1) {
            xValues.push(x);
            const sigmoid = 1 / (1 + Math.exp(-x));
            sigmoidValues.push(sigmoid);
            sigmoidDerivValues.push(sigmoid * (1 - sigmoid));
        }
        
        new Chart(sigmoidCtx, {
            type: 'line',
            data: {
                labels: xValues,
                datasets: [{
                    label: 'Sigmoid œÉ(x)',
                    data: sigmoidValues,
                    borderColor: '#e74c3c',
                    backgroundColor: 'rgba(231, 76, 60, 0.1)',
                    borderWidth: 3,
                    fill: true
                }, {
                    label: "Sigmoid Derivative œÉ'(x)",
                    data: sigmoidDerivValues,
                    borderColor: '#3498db',
                    backgroundColor: 'rgba(52, 152, 219, 0.1)',
                    borderWidth: 3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Sigmoid Function and its Derivative'
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Input (x)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Output'
                        }
                    }
                }
            }
        });

        // XOR visualization
        const xorCtx = document.getElementById('xorChart').getContext('2d');
        new Chart(xorCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'XOR = 0',
                    data: [{x: 0, y: 0}, {x: 1, y: 1}],
                    backgroundColor: '#e74c3c',
                    pointRadius: 15
                }, {
                    label: 'XOR = 1',
                    data: [{x: 0, y: 1}, {x: 1, y: 0}],
                    backgroundColor: '#27ae60',
                    pointRadius: 15
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'XOR Problem - Not Linearly Separable'
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'X‚ÇÅ'
                        },
                        min: -0.2,
                        max: 1.2
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'X‚ÇÇ'
                        },
                        min: -0.2,
                        max: 1.2
                    }
                }
            }
        });

        // Training simulation
        let lossChart;
        let trainingData = [];
        let currentEpoch = 0;
        
        function initializeLossChart() {
            const lossCtx = document.getElementById('lossChart').getContext('2d');
            lossChart = new Chart(lossCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Training Loss',
                        data: [],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Training Loss Over Time'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Epoch'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Loss (MSE)'
                            }
                        }
                    }
                }
            });
        }
        
        function simulateTraining() {
            const output = document.getElementById('training-output');
            output.innerHTML = 'Starting training simulation...\n';
            
            currentEpoch = 0;
            trainingData = [];
            
            const simulateStep = () => {
                if (currentEpoch >= 2000) {
                    output.innerHTML += '\nTraining completed!\nFinal results:\n';
                    output.innerHTML += 'Input [0,0] -> Output: 0.023\n';
                    output.innerHTML += 'Input [0,1] -> Output: 0.977\n';
                    output.innerHTML += 'Input [1,0] -> Output: 0.976\n';
                    output.innerHTML += 'Input [1,1] -> Output: 0.034\n';
                    output.innerHTML += 'Network successfully learned XOR!';
                    return;
                }
                
                // Simulate decreasing loss with some noise
                const baseLoss = 0.25 * Math.exp(-currentEpoch / 400) + 0.001;
                const noise = (Math.random() - 0.5) * 0.01;
                const loss = Math.max(0.001, baseLoss + noise);
                
                if (currentEpoch % 200 === 0) {
                    output.innerHTML += `Epoch ${currentEpoch}, Loss: ${loss.toFixed(6)}\n`;
                    output.scrollTop = output.scrollHeight;
                }
                
                trainingData.push({epoch: currentEpoch, loss: loss});
                
                // Update chart every 50 epochs
                if (currentEpoch % 50 === 0) {
                    lossChart.data.labels.push(currentEpoch);
                    lossChart.data.datasets[0].data.push(loss);
                    lossChart.update('none');
                }
                
                currentEpoch += 50;
                setTimeout(simulateStep, 100);
            };
            
            simulateStep();
        }
        
        function resetTraining() {
            currentEpoch = 0;
            trainingData = [];
            document.getElementById('training-output').innerHTML = '';
            lossChart.data.labels = [];
            lossChart.data.datasets[0].data = [];
            lossChart.update();
        }

        // Weight initialization comparison
        const initCtx = document.getElementById('initChart').getContext('2d');
        
        // Generate sample weight distributions
        const generateWeights = (mean, std, count) => {
            const weights = [];
            for (let i = 0; i < count; i++) {
                // Box-Muller transform for normal distribution
                const u = Math.random();
                const v = Math.random();
                const z = Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * v);
                weights.push(mean + std * z);
            }
            return weights;
        };
        
        const xavierWeights = generateWeights(0, Math.sqrt(2 / 10), 1000); // Xavier for our network
        const heWeights = generateWeights(0, Math.sqrt(2 / 2), 1000); // He initialization
        const smallWeights = generateWeights(0, 0.1, 1000); // Too small
        
        // Create histogram data
        const createHistogram = (weights, bins = 20) => {
            const min = Math.min(...weights);
            const max = Math.max(...weights);
            const binWidth = (max - min) / bins;
            const histogram = new Array(bins).fill(0);
            const binCenters = [];
            
            for (let i = 0; i < bins; i++) {
                binCenters.push(min + (i + 0.5) * binWidth);
            }
            
            weights.forEach(weight => {
                const binIndex = Math.min(Math.floor((weight - min) / binWidth), bins - 1);
                histogram[binIndex]++;
            });
            
            return { binCenters, histogram };
        };
        
        const xavierHist = createHistogram(xavierWeights);
        const heHist = createHistogram(heWeights);
        const smallHist = createHistogram(smallWeights);
        
        new Chart(initCtx, {
            type: 'bar',
            data: {
                labels: xavierHist.binCenters.map(x => x.toFixed(2)),
                datasets: [{
                    label: 'Xavier Init (‚àö(2/(fan_in+fan_out)))',
                    data: xavierHist.histogram,
                    backgroundColor: 'rgba(52, 152, 219, 0.7)',
                    borderColor: '#3498db',
                    borderWidth: 1
                }, {
                    label: 'He Init (‚àö(2/fan_in))',  
                    data: heHist.histogram,
                    backgroundColor: 'rgba(231, 76, 60, 0.7)',
                    borderColor: '#e74c3c',
                    borderWidth: 1
                }, {
                    label: 'Too Small (std=0.1)',
                    data: smallHist.histogram,
                    backgroundColor: 'rgba(149, 165, 166, 0.7)',
                    borderColor: '#95a5a6',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Weight Initialization Distributions'
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Weight Value'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Frequency'
                        }
                    }
                }
            }
        });
        
        // Initialize loss chart
        initializeLossChart();
    </script>
</body>
</html>